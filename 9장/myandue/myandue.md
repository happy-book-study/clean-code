### 9장. 단위 테스트

- **TDD 법칙 세 가지**
    - 실패하는 단위 테스트를 작성할 때까지 실제 코드를 작성하지 않는다.
    - 컴파일은 실패하지 않으면서 실행이 실패하는 정도로만 단위 테스트를 작성한다.
    - 현재 실패하는 테스트를 통과할 정도로만 실제 코드를 작성한다.
- 분명 영한님이 실제 개발자는 오히려 테스트 코드 작성하는게 80퍼센트라고 하셨었는데 실상 그렇지가 못하더라.. 나도 테스트코드 작성하고싶다…
- 테스트는 유연성, 유지보수성, 재사용성을 제공한다.
    - 한가지 기능을 업그레이드 시키거나 아예 새로운 기능을 추가할 때 기존의 코드가 정상적으로 돌아가는지 끊임없이 포스트맨을 이용하고, 그마저도 빈틈이 있을것이 분명하다고 생각이 들 때 TDD의 필요성을 여실히 느꼈다.
- 테스트코드 또한 계속 확장되기 때문에, 실제 코드와 마찬가지로 클린 코드를 유지해야한다.
- **깨끗한 테스트 코드**
    - 깨끗한 테스트 코드에 가장 필요한 것은 가독성이다. 잡다하고 세세한 코드를 없애야한다.
    - **도메인에 특화된 테스트 언어**
        - 도메인 특화 언어(DSL)로 테스트 코드를 구현하는 기법..이 뭔지 잘 모르겠다!
    - **이중 표준**
        - 테스트 API 코드에 적용하는 표준은 실제 코드에 적용하는 표준과 다르다.
        - 깨끗하게 잘 짜야만하지만, 실제 코드만큼 효율적일 필요는 없다. 환경이 실제 환경이 아니기 때문이다.
        - 예시를 보고 ‘오잉?’ 했는데, 테스트코드에서는 이렇게 쓰는 것이 나은가보다.
            - 리팩토링 전
                
                ```java
                @Test
                public void turnOnLoTempAlarmAtThreadshold() throws Exception {
                	hw.setTemp(WAY_TOO_COLD);
                	controller.tic();
                	assertTrue(hw.heaterState());
                	assertTrue(hw.blowerState());
                	assertFalse(hw.coolerState());
                	assertFalse(hw.hiTempAlarm());
                	assertTrue(hw.loTempAlarm());
                }
                ```
                
                - 위 코드를 읽으면 자연스럽게 assert 메서드 안의 값을 확인하고(히터?쿨러?) assert 메서드가 True인지 False 인지 체크하게된다.
            - 리팩토링 후
                
                ```java
                @Test
                public void turnOnLoTempAlarmAtThreadshold() throws Exception {
                	wayTooCold();
                	assertEquals("HBchL", hw.getState());
                }
                ```
                
                - 뭔지 모르겠는 tic() 메서드는 wayTooCold() 메서드에 숨겨졌다.
                - “HBchL”에서 대문자는 켜짐, 소문자는 꺼짐을 뜻한다.
                - 이렇게 되면 어떤것을 켰을 때 어떤 것이 꺼지고 켜지는지를 단순히 문자열을 통해 나타내고 확인할 수 있게된다.
- **F.I.R.S.T**
    - **FAST**: 테스트는 빨라야한다. 자주 돌려야하기때문에.
    - **INDEPENDENT**: 각 테스트는 서로 의존하면 안된다. 실패 했을 시 실패 원인이 되는 테스트 케이스를 찾아내야하기 때문이다.
    - **REPEATABLE**: 환경과 무관하게 어떤 환경에서도 반복 가능해야 한다.
    - **SELF-VALIDATING**: BOOL 값으로 결과를 내야한다. 로그를 통해 주관적인 판단을 하지 않도록한다.
    - **TIMELY**: 단위테스트는 실제 코드 구현 전에 하도록한다. 실제 코드를 먼저 작성하면 테스트하기 어렵다고 판명날 수 있다.
